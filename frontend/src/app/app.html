<!-- Application layout -->
<div class="app-container">
  <!-- Navigation for authenticated users -->
  <div *ngIf="isAuthenticated()" class="app-layout">
    <!-- Top toolbar -->
    <mat-toolbar class="app-toolbar" color="primary">
      <div class="toolbar-content">
        <div class="app-title">
          <mat-icon>emoji_events</mat-icon>
          <span>Gamification Hub</span>
        </div>
        
        <div class="user-menu" *ngIf="currentUser">
          <button mat-button [matMenuTriggerFor]="userMenu" class="user-button">
            <mat-icon>account_circle</mat-icon>
            <span>{{ currentUser.username }}</span>
            <mat-icon>keyboard_arrow_down</mat-icon>
          </button>
          
          <mat-menu #userMenu="matMenu">
            <div class="user-info">
              <div class="user-details">
                <strong>{{ currentUser.username }}</strong>
                <small>{{ currentUser.email }}</small>
              </div>
            </div>
            <mat-divider></mat-divider>
            <button mat-menu-item (click)="logout()">
              <mat-icon>logout</mat-icon>
              <span>Logout</span>
            </button>
          </mat-menu>
        </div>
      </div>
    </mat-toolbar>

    <!-- Main layout with sidebar -->
    <mat-sidenav-container class="app-sidenav-container">
      <!-- Sidebar navigation -->
      <mat-sidenav
        class="app-sidenav"
        fixedInViewport="true"
        mode="side"
        opened="true">
        <mat-nav-list class="navigation-list">
          <mat-list-item 
            *ngFor="let item of navigationItems" 
            [routerLink]="item.path"
            routerLinkActive="active"
            class="nav-item">
            <mat-icon matListItemIcon>{{ item.icon }}</mat-icon>
            <div matListItemTitle>{{ item.label }}</div>
          </mat-list-item>
        </mat-nav-list>
      </mat-sidenav>

      <!-- Main content -->
      <mat-sidenav-content class="app-content">
        <router-outlet></router-outlet>
      </mat-sidenav-content>
    </mat-sidenav-container>
  </div>

  <!-- Full-screen layout for unauthenticated users (login/register) -->
  <div *ngIf="!isAuthenticated()" class="auth-layout">
    <router-outlet></router-outlet>
  </div>
</div>